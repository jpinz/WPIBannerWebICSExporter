var ics=function(){if(navigator.userAgent.indexOf("MSIE")>-1&&-1==navigator.userAgent.indexOf("MSIE 10")){return void console.log("Unsupported Browser")}
var h=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",f=[],g=["BEGIN:VCALENDAR","PRODID:-//JPINZ//WPI Schedule//EN","VERSION:2.0","METHOD:PUBLISH","X-WR-CALNAME:My WPI Academic Schedule","BEGIN:VTIMEZONE","TZID:US-Eastern","END:VTIMEZONE"].join(h),e=h+"END:VCALENDAR";return{events:function(){return f},calendar:function(){return g+h+f.join(h)+e},addEvent:function(X,aa,ab,Y,Z,R){if("undefined"==typeof X||"undefined"==typeof aa||"undefined"==typeof ab||"undefined"==typeof Y||"undefined"==typeof Z){return !1}
if(R&&!R.rule){if("YEARLY"!==R.freq&&"MONTHLY"!==R.freq&&"WEEKLY"!==R.freq&&"DAILY"!==R.freq){throw "Recurrence rule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'"}
if(R.until&&isNaN(Date.parse(R.until))){throw "Recurrence rule 'until' must be a valid date string"}
if(R.interval&&isNaN(parseInt(R.interval))){throw "Recurrence rule 'interval' must be an integer"}
if(R.count&&isNaN(parseInt(R.count))){throw "Recurrence rule 'count' must be an integer"}}
var S=new Date(Y),P=new Date(Z),Q=("0000"+S.getFullYear().toString()).slice(-4),V=("00"+(S.getMonth()+1).toString()).slice(-2),W=("00"+S.getDate().toString()).slice(-2),T=("00"+S.getHours().toString()).slice(-2),U=("00"+S.getMinutes().toString()).slice(-2),J=("00"+S.getMinutes().toString()).slice(-2),K=("0000"+P.getFullYear().toString()).slice(-4),H=("00"+(P.getMonth()+1).toString()).slice(-2),I=("00"+P.getDate().toString()).slice(-2),N=("00"+P.getHours().toString()).slice(-2),O=("00"+P.getMinutes().toString()).slice(-2),L=("00"),M="",F="";U+J+O+L!==0&&(M="T"+T+U+J,F="T"+N+O+L);var G,E=Q+V+W+M,D=K+H+I+F;if(R){if(R.rule){G=R.rule}else{if(G="RRULE:FREQ="+R.freq,R.until){var a=new Date(Date.parse(R.until)).toISOString();G+=";UNTIL="+a.substring(0,a.length-13).replace(/[-]/g,"")+"000000Z"}
R.interval&&(G+=";INTERVAL="+R.interval),R.count&&(G+=";COUNT="+R.count)}}
var b=["BEGIN:VEVENT","CLASS:PUBLIC","DESCRIPTION:"+aa,"DTSTART;VALUE=DATE:"+E,"DTEND;VALUE=DATE:"+D,"LOCATION:"+ab,"SUMMARY;LANGUAGE=en-us:"+X,"TRANSP:TRANSPARENT","END:VEVENT"];return G&&b.splice(4,0,G),b=b.join(h),f.push(b),b},download:function(a,d){if(f.length<1){return !1}
d="undefined"!=typeof d?d:".ics",a="undefined"!=typeof a?a:"calendar";var j,b=g+h+f.join(h)+e;if(-1===navigator.userAgent.indexOf("MSIE 10")){j=new Blob([b])}else{var c=new BlobBuilder;c.append(b),j=c.getBlob("text/x-vCalendar;charset="+document.characterSet)}
return saveAs(j,a+d),b}}}